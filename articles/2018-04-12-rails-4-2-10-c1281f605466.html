<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width">
  <title>Rails 4.2.10 の変更点</title>
  <link href="https://r7kamura.com/articles/2018-04-12-rails-4-2-10-c1281f605466" rel="canonical">
  <link rel="stylesheet" href="/css/main.css">
  <link rel="search" type="application/opensearchdescription+xml" title="r7kamura.com" href="/opensearch.xml">
  <link rel="alternate" type="application/rss+xml" href="/feed.xml">
  
  <meta property="description" content="Rails 4.2.9 から 4.2.10 にかけての変更点をまとめます。">
  <meta property="og:description" content="Rails 4.2.9 から 4.2.10 にかけての変更点をまとめます。">
  
  <meta property="og:type" content="website">
  <meta property="og:title" content="Rails 4.2.10 の変更点">
  <meta property="og:url" content="https://r7kamura.com/articles/2018-04-12-rails-4-2-10-c1281f605466">
  
  <meta property="og:image" content="https://r7kamura.com/default_og_image.jpg">
  <meta property="twitter:card" content="summary">
  
</head>
<body>
  <header>
    <nav>
      <p>
        <a href="/">r7kamura.com</a>
      </p>
      <ul>
        <li>
          <a href="/links">リンク集</a>
        </li>
        <li>
          <a href="https://www.google.com/search?q=site:r7kamura.com">検索</a>
        </li>
      </ul>
    </nav>
  </header>
  <main>
    <article>
  <header>
    <time datetime="2018-04-12T00:00:00+00:00">2018年04月12日</time>
    <h1>Rails 4.2.10 の変更点</h1>
  </header>
  <div>
    <p>Rails 4.2.9 から 4.2.10 にかけての変更点をまとめます。</p>

<p><a href="https://github.com/rails/rails/compare/v4.2.9...v4.2.10">rails/rails</a></p>

<p><a href="https://medium.com/@r7kamura/rails-4-2-9-d391597ab04">Rails 4.2.9 の変更点</a></p>

<h3>actionpack</h3>

<h2>パスを処理する中でエンコーディングを保持するための変更が差し戻され、更に常に UTF-8 で扱われるようになった</h2>

<p>パスを処理する中でエンコーディングが変わってしまうという問題があり、これについて Rails 4.2.9 で修正が加えられました。しかし、これは加えるべき変更ではなかったとして今回差し戻されました。</p>

<p>更に、Ruby 2.0.0 では文字列リテラルの先頭以外で ASCII-compatible で ASCII-8BIT エンコーディングな文字列を展開した際 (例: “foo #{‘bar’.b}”) に文字列全体のエンコーディングが UTF-8 ではなく ASCII-8IT になるという違いがあり、バージョン間の挙動を統一するために、ここでは常に UTF-8 エンコーディングの文字列が返されるように変更されました。</p>

<p><a href="https://github.com/rails/rails/commit/a7d49ef78c36df2d1ca876451f30915ada1079a5">Restore previous behavior of normalize_path · rails/rails@a7d49ef</a></p>

<h3>activerecord</h3>

<h2>joins が引数の scope の状態に左右されなくなった (但し unscoped を除く)</h2>

<p>activerecord 4.2.8 で、unscoped が joins にきちんと影響するように変更が加えられましたが、この変更が原因で scope の状態が全て joins に影響するようになってしまいました。scope の joins への影響の是非はともかくとして、Rails 4.2 で挙動の変更が加えられるのは避けるべきだとして修正が加えられ、unscoped を除く scope の状態は joins に影響しなくなりました。</p>

<p><a href="https://github.com/rails/rails/commit/5e7fc65e4c3d4ef6f3584362376fc5f9ccbf39ff">Post.joins(:users) should not be affected by `User.current_scope` · rails/rails@5e7fc65</a></p>

<h2>mysql adapter で precision 付きの datetime 型を正しく扱えるようになった</h2>

<p>表題の通りで、mysql2 adapter に加えて mysql adapter でも、precision (精度) 付きの datetime 型のフィールドを正しく扱えるようになりました。Rails 5 では mysql adapter は廃止されます。</p>

<p><a href="https://github.com/rails/rails/pull/30651">4-2-stable: Fix datetime with precision for mysql adapter by kamipo · Pull Request #30651 ·…</a></p>

  </div>
</article>

  </main>
</body>
</html>
