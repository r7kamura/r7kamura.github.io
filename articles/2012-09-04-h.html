<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width">
  <title>The RSpec Book読んだ後に残ってたメモ</title>
  <link href="https://r7kamura.com/articles/2012-09-04-h" rel="canonical">
  <link rel="stylesheet" href="/css/main.css">
  <link rel="search" type="application/opensearchdescription+xml" title="r7kamura.com" href="/opensearch.xml">
  <link rel="alternate" type="application/rss+xml" href="/feed.xml">
  
  <meta property="description" content="リファクタリングとは、コードの振る舞いを変えずにその設計を変えること。">
  <meta property="og:description" content="リファクタリングとは、コードの振る舞いを変えずにその設計を変えること。">
  
  <meta property="og:type" content="website">
  <meta property="og:title" content="The RSpec Book読んだ後に残ってたメモ">
  <meta property="og:url" content="https://r7kamura.com/articles/2012-09-04-h">
  
  <meta property="og:image" content="https://r7kamura.com/default_og_image.jpg">
  <meta property="twitter:card" content="summary">
  
</head>
<body>
  <header>
    <nav>
      <p>
        <a href="/">r7kamura.com</a>
      </p>
      <ul>
        <li>
          <a href="/links">リンク集</a>
        </li>
        <li>
          <a href="https://www.google.com/search?q=site:r7kamura.com">検索</a>
        </li>
      </ul>
    </nav>
  </header>
  <main>
    <article>
  <header>
    <time datetime="2012-09-04T00:00:00+00:00">2012年09月04日</time>
    <h1>The RSpec Book読んだ後に残ってたメモ</h1>
  </header>
  <div>
    <h3>リファクタリング</h3>

<p>リファクタリングとは、コードの振る舞いを変えずにその設計を変えること。<br>
コードの振る舞いが変わる場合、それはリファクタリングではない何か。</p>

<h3>テスト対象</h3>

<p>オブジェクトが、何であるかをテストするのは良くなく、何をするかをテストすることが重要。<br>
例えば、RDBMSを使って保存されることではなく、DBに保存されるということが重要。</p>

<h3>怪しいコードの特徴</h3>

<ul>
<li>1つのメソッドでやることが多い、長い</li>
<li>一時変数が多い</li>
<li>OOPなのに手続き型風</li>
<li>同じスコープの複数のメソッドがグループを形成している</li>
</ul>

<h3>テストの手順</h3>

<p>Red, Green, Refactorの順に行う。<br>
Redから始まり、器を用意することで例外とエラーを解消し、<br>
次に振る舞いを実装することで論理エラーを解消する。<br>
Refactorは常にGreenを維持するように努力を払いながら行う。<br>
その過程に冗長な実装が記述されることも厭わない。</p>

<h3>テストの粒度</h3>

<p>オブジェクトの振る舞いという観点でテストを記述できる。RSpecが得意。<br>
別の観点から、アプリケーションの振る舞いという観点でテストを記述できる。Cucumberが得意。<br>
粒度は揃えた方が良いので、この2つの観点を混同させてはいけない。</p>

<h3>どのフィーチャーから手を付けるか</h3>

<p>ビジネスバリューの点から言えばどれからでも同じであるため、<br>
最もやりやすいものから手を付けるのが正しい。</p>

<h3>テストをPending状態にするタイミング</h3>

<p>これから変更を行うが、確実に失敗するテストが明確であり、<br>
それらの失敗を新たに発覚する失敗と混同したくない場合。</p>

<h3>BDD</h3>

<p>BDDは設計手法の1つであり、厳密には本物のアプリをテストしているわけではない。<br>
ただ実行可能なサンプルをつくっているだけ。</p>

<h3>BDDの視点</h3>

<p>サービス提供者ではなくステークホルダーの視点の振る舞いを説明する。<br>
サービス提供者がステークホルダーに含まれることもある。</p>

<h3>TDD</h3>

<p>あると良いと思うコードをまず書く。<br>
サンプルが実際にテストするかどうかはそれほど重要ではない。<br>
振る舞いを説明することが重要。</p>

<h3>テストの構成要素</h3>

<ul>
<li>事前条件</li>
<li>入力</li>
<li>イベント</li>
<li>出力</li>
</ul>

<h3>テストの主語</h3>

<p>テストを表すメッセージにおいて、主語が誰かというのを明示することは大事。</p>

<h3>良い目標</h3>

<ul>
<li>完了したことを知るのに十分な情報がある</li>
<li>現実的に完了できる</li>
<li>期限が付いている</li>
</ul>

<h3>ストーリーの構成要素</h3>

<ul>
<li>タイトル(識別するため)</li>
<li>ステークホルダーの望む機能とその理由</li>
<li>いつ完了になるか分かる基準(前提とイベントと結果)</li>
</ul>

  </div>
</article>

  </main>
</body>
</html>
